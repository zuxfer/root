// Generated by CoffeeScript 1.6.1
(function () {
    var e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g, y, b, w, E, S, x, T, N, C, k, L, A, O, M, _, D, P, H, B, j, F, I, q, R, U, z, W, X, V, $, J, K, Q, G, Y, Z, et, tt, nt, rt, it, st, ot, ut, at, ft, lt, ct, ht, pt, dt, vt, mt, gt, yt, bt, wt, Et, St, xt, Tt, Nt, Ct, kt;
    v = [], q = 0, bt = function (e) {
        var t, n, r, i, s;
        e === 0 && (e = 65535), t = 0, v = [], s = [];
        for (r = 0, i = data.length; r < i; r++) n = data[r], s.push(function (n) {
            return n[3] = !1, e & 1 << t && (v.push(n), n[3] = !0), t += 1
        }(n));
        return s
    }, Y = function () {
        var e, t, n, r, i, s;
        e = 0, n = 0, r = function (t) {
            return t[3] && (n += 1 << e), e += 1
        };
        for (i = 0, s = data.length; i < s; i++) t = data[i], r(t);
        return n.toString(36)
    }, U = {}, nt = function () {
        var e, t, n;
        return n = new Date, e = n.getUTCHours() * 60 + n.getUTCMinutes(), t = e - 720, U = {
            date: n,
            offset: t,
            cities: 65535
        }
    }, nt(), xt = function () {
        var e, t, n, r, i;
        if (location.hash === "") return;
        return i = location.hash.slice(1).split(","), n = i[0], r = i[1], t = i[2], e = n.split("-"), U.date = new Date(e[0], e[1] - 1, e[2]), U.offset = parseInt(r), U.cities = parseInt(t, 36)
    }, navigator.standalone == null && !navigator.standalone && xt(), bt(U.cities), q = U.offset, O = !1, e = function (e) {
        return document.getElementById(e)
    }, L = function (t, n) {
        return n == null && (n = ""), (e(t) || t).innerHTML = n
    }, b = function (t, n) {
        return (e(t) || t).style.cssText += ";" + n
    }, yt = navigator.userAgent, M = yt.match(/(iPhone\sOS)\s([\d_]+)/) || yt.match(/(iPad\sOS)\s([\d_]+)/), Ct = yt.indexOf("AppleWebKit/") > -1, I = yt.indexOf("Gecko") > -1 && !Ct, R = yt.indexOf("Opera") > -1, A = yt.indexOf("MSIE") > -1, d = yt.indexOf("Chrome") > -1, n = yt.match(/(Android)\s+([\d.]+)/) && Ct, r = yt.match(/(Android)\s+4([\d.]+)/) && Ct, vt = Ct ? "webkitTransform" : A ? "msTransform" : I ? "MozTransform" : R ? "OTransform" : "transform", mt = Ct ? "-webkit-transform" : A ? "-ms-transform" : I ? "-moz-transform" : R ? "-o-transform" : void 0, pt = Ct ? "-webkit-transition" : A ? "-ms-transition" : I ? "-moz-transition" : R ? "-o-transition" : void 0, i = function (e, t, n, r) {
        return n == null && (n = 1), r == null && (r = .5), b(e, "" + pt + ":all " + r + "s; " + mt + ":    " + t + "; opacity:" + n)
    }, dt = function (t, n, r) {
        r == null && (r = !1);
        if (isNaN(n)) return;
        return t = e(t), r && (t.style.cssText += ";" + pt + ":all 0.4s;"), t.style[vt] = Ct && st ? "translate3d(" + n + "px,0,0)" : "translate3d(" + n + "px,0,0)"
    }, at = "left", j = "January February March April May June July August September October November December".split(" "), Date.prototype.addDays = function (e) {
        return new Date(this.getTime() + e * 1e3 * 60 * 60 * 24)
    }, Function.prototype.delay = function (e) {
        return setTimeout(this, e * 1e3)
    }, st = document.createTouch != null, z = window.devicePixelRatio || 1, f = e("body"), p = e("canvas"), y = p.getContext("2d"), z > 1 && (y.webkitBackingStorePixelRatio || 1) > 1 && (z = 1), kt = k = a = u = Q = _ = null, E = t = H = K = ft = l = null, w = B = ot = null, o = ut = null, y.save(), st && (f.className = "supports-touch"), d && (f.className = "chrome"), M && (f.className = "supports-touch with-initial-animation"), et = function (e, t, n) {
        return e.setAttribute("width", t * z), e.setAttribute("height", n * z), b(e, "height:" + n + "px; width:" + t + "px")
    }, rt = function () {
        var t, r, i, s;
        i = function () {
            var t, n, r, i, s;
            r = e("select_timezones"), t = -1;
            for (i = 0, s = data.length; i < s; i++) n = data[i], r.appendChild(new Option("" + n[1] + " (" + n[2] + ")", t += 1, !1, n[3]));
            return r.onchange = function () {
                var e, t, n, i, s, o;
                e = 0, n = 0, i = function (t) {
                    return r.options[e].selected && (n += 1 << e), e += 1
                };
                for (s = 0, o = data.length; s < o; s++) t = data[s], i(t);
                return bt(n), V(), Nt()
            }
        }, s = function (e) {
            return document.adoptNode((new DOMParser).parseFromString(e, "text/xml").firstChild)
        }, t = function (e) {
            var t;
            return t = '  <svg class="action" width="12px" height="10px" viewBox="0 0 12 10" version="1.1" xmlns="http://www.w3.org/2000/svg">\n<g><path d="M12,3.5L8,0v2.25c0,0-5,0.75-5,5C4.5,5,8,4.75,8,4.75V7L12,3.5z"/></g>\n<g><polygon points="10,7 9,8 9,9 1,9 1,3 3.5,3 4.5,2 0,2 0,10 10,10"/></g>\n</svg>', e.appendChild(s(t))
        }, r = function (e) {
            var t;
            return t = '      <svg class="action" width="36px" height="36px" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg">\n        <path fill="#FFFFFF" d="M23.077,10.154h-1.106c-0.508,0-1.047-0.397-1.198-0.883l-0.636-1.545c-0.239-0.447-0.141-1.107,0.216-1.467\nl0.788-0.785c0.359-0.359,0.359-0.947,0-1.307l-1.309-1.305c-0.358-0.359-0.945-0.359-1.305,0l-0.788,0.785\nc-0.356,0.358-1.019,0.457-1.467,0.217l-1.543-0.637c-0.483-0.149-0.881-0.688-0.881-1.197V0.924C13.849,0.417,13.432,0,12.924,0\nh-1.847c-0.508,0-0.924,0.417-0.924,0.924v1.107c0,0.509-0.396,1.048-0.881,1.197L7.728,3.865c-0.449,0.24-1.106,0.143-1.466-0.217\nL5.474,2.863c-0.359-0.359-0.945-0.359-1.304,0L2.864,4.168c-0.36,0.359-0.36,0.947,0,1.307L3.647,6.26\nc0.36,0.359,0.459,1.02,0.217,1.467L3.229,9.273c-0.152,0.484-0.688,0.881-1.197,0.881H0.924C0.416,10.154,0,10.568,0,11.077v1.846\nc0,0.509,0.416,0.925,0.924,0.925h1.108c0.509,0,1.045,0.396,1.195,0.881l0.637,1.547c0.241,0.447,0.144,1.109-0.217,1.467\nl-0.785,0.785c-0.358,0.359-0.358,0.947,0,1.307l1.308,1.307c0.358,0.357,0.944,0.357,1.304,0l0.788-0.787\nc0.357-0.357,1.017-0.455,1.462-0.213l1.549,0.635c0.485,0.152,0.881,0.689,0.881,1.197v1.105c0,0.506,0.416,0.922,0.924,0.922\nh1.847c0.508,0,0.925-0.416,0.925-0.922v-1.105c0-0.508,0.397-1.045,0.881-1.197l1.548-0.635c0.446-0.242,1.107-0.145,1.467,0.213\nl0.783,0.787c0.359,0.357,0.946,0.357,1.305,0l1.309-1.307c0.359-0.359,0.359-0.947,0-1.307l-0.788-0.785\nc-0.356-0.357-0.455-1.02-0.216-1.467l0.636-1.547c0.151-0.484,0.693-0.881,1.198-0.881h1.106c0.509,0,0.923-0.414,0.923-0.923\nv-1.848C24,10.568,23.586,10.154,23.077,10.154 M16.619,11.999c0,2.55-2.066,4.614-4.615,4.614c-2.552,0-4.617-2.064-4.617-4.614\nc0-2.549,2.065-4.615,4.617-4.615C14.553,7.384,16.619,9.45,16.619,11.999"/>\n      </svg>', e.appendChild(s(t))
        }, t(e("action_icon")), r(e("edit_icon")), navigator.standalone && (f.className += " standalone"), i();
        if (!st) return L("shortcut_link", "");
        L("shortcut_link", "tap &amp; hold to share");
        if (n) return e("tap_to_add").style.display = "none"
    }, it = function () {
        var e, n, r, i, s, o, f, c, h, p;
        E = y.createLinearGradient(0, 0, a * z, 0), t = y.createLinearGradient(0, 0, a * z, 0), H = y.createLinearGradient(0, 0, a * z, 0), K = y.createLinearGradient(0, 0, 0, u * z), ft = y.createLinearGradient(0, 0, 0, u * z), l = y.createLinearGradient(0, u * z, 0, 0), c = [
            [0, "#4b4c4d"],
            [.2499, "#4b4c4d"],
            [.25, "#575b5c"],
            [.3299, "#575b5c"],
            [.33, "#6b7071"],
            [.7499, "#6b7071"],
            [.75, "#575b5c"],
            [.9099, "#575b5c"],
            [.91, "#4b4c4d"],
            [1, "#4b4c4d"]
        ];
        for (n = 0, s = c.length; n < s; n++) e = c[n], E.addColorStop(e[0], e[1]);
        h = [
            [0, "#5485b1"],
            [.2499, "#5485b1"],
            [.25, "#3cafc5"],
            [.3299, "#3cafc5"],
            [.33, "#55c8e4"],
            [.7499, "#55c8e4"],
            [.75, "#3cafc5"],
            [.9099, "#3cafc5"],
            [.91, "#5485b1"],
            [1, "#5485b1"]
        ];
        for (r = 0, o = h.length; r < o; r++) e = h[r], t.addColorStop(e[0], e[1]);
        p = [
            [0, "#8abb29"],
            [.2499, "#8abb29"],
            [.25, "#a5df3b"],
            [.3299, "#a5df3b"],
            [.33, "#b8ff41"],
            [.7499, "#b8ff41"],
            [.75, "#a5df3b"],
            [.9099, "#a5df3b"],
            [.91, "#8abb29"],
            [1, "#8abb29"]
        ];
        for (i = 0, f = p.length; i < f; i++) e = p[i], H.addColorStop(e[0], e[1]);
        return K.addColorStop(0, "rgba(0,0,0,0)"), K.addColorStop(1, "rgba(0,0,0,0.4)"), ft.addColorStop(0, "rgba(255,255,255,0.3)"), ft.addColorStop(.025, "rgba(255,255,255,0)"), l.addColorStop(0, "rgba(255,255,255,0.3)"), l.addColorStop(.025, "rgba(255,255,255,0)")
    }, J = function (e, t, n, r) {
        return r == null && (r = y), r.beginPath(), r.moveTo(n, 0), r.lineTo(e - n, 0), r.quadraticCurveTo(e, 0, e, n), r.lineTo(e, t - n), r.quadraticCurveTo(e, t, e - n, t), r.lineTo(n, t), r.quadraticCurveTo(0, t, 0, t - n), r.lineTo(0, n), r.quadraticCurveTo(0, 0, n, 0), r.fill()
    }, c = {}, x = function (e, n, r) {
        var i, s, o, f, h;
        return r == null && (r = E), r === E && (o = "default"), r === t && (o = "active"), r === H && (o = "local"), c[o] || (i = document.createElement("canvas"), et(i, a * z, u * z), s = i.getContext("2d"), h = (a - 2) * z, f = u * z, s.fillStyle = r, s.clearRect(0, 0, h, f), J(h, f, f / 2.5, s), s.fillStyle = K, J(h, f, f / 2.5, s), s.fillStyle = ft, J(h, f, f / 2.5, s), s.fillStyle = l, J(h, f, f / 2.5, s), c[o] = i), y.clearRect(e, n, a, u), y.drawImage(c[o], e, n, a * z, u * z)
    }, tt = function (e) {
        return e == null && (e = U.date), w = e, B = -(w.getTimezoneOffset() / 60), ot = w.getUTCHours() * 60 + w.getUTCMinutes()
    }, W = function () {
        var e;
        return e = [window.innerWidth, v.length * 60 + 350], kt = e[0], k = e[1], a = kt / 3, kt > 480 && (k -= 100), Q = 60, u = 24, _ = kt / 2 - a * 3 / 2, et(p, kt, k), y.restore(), y.save(), y.scale(z, z), y.clearRect(0, 0, kt, k), b("header", "width:" + a * 3 + "px;left:" + (kt / 2 - a * 3 / 2) + "px"), b("line", "height:" + (k - 82 - 100) + "px"), b("cline", "height:" + (k - 82 - 100) + "px"), b("wrapper", "height:" + k + "px")
    }, C = function (e, n) {
        var r;
        return r = n + 12, r >= 0 && r < 24 ? e === B ? H : t : E
    }, X = function () {
        var t, n, r, i, s, u, f, l, c, h, p, d, m, g;
        l = 115, i = 0, t = kt / 2 - a / 2, f = "", r = "", s = "", o = [], ut = [], c = function (e) {
            var n, u;
            return n = -e[0] / 24 * a, u = i * Q + l, o.push([{
                left: n + t - a * 2,
                top: u + 20,
                gradient: C(e[0], e[0] + 48 + q / 60)
            }, {
                left: n + t - a,
                top: u + 20,
                gradient: C(e[0], e[0] + 24 + q / 60)
            }, {
                left: n + t,
                top: u + 20,
                gradient: C(e[0], e[0] + q / 60)
            }, {
                left: n + t + a,
                top: u + 20,
                gradient: C(e[0], e[0] - 24 + q / 60)
            }, {
                left: n + t + a * 2,
                top: u + 20,
                gradient: C(e[0], e[0] - 48 + q / 60)
            }]), ut.push({
                offset: e[0]
            }), x(o[i][1].left, o[i][1].top, o[i][1].gradient), x(o[i][2].left, o[i][2].top, o[i][2].gradient), x(o[i][3].left, o[i][3].top, o[i][3].gradient), f += "<div style='left:" + _ + "px;top:" + (u - 2) + "px'>" + e[1] + " <small>" + e[2] + "</small></div>", s += "<div id='time_" + i + "' style='top:" + (u - 2) + "px'></div>", r += "<div style='left:" + o[i][1].left + "px;top:" + o[i][1].top + "px;width:" + a + "px'>\n  " + T(w.addDays(-1)) + "\n</div>\n<div style='left:" + o[i][2].left + "px;top:" + o[i][2].top + "px;width:" + a + "px'>\n  " + T(w.addDays(0)) + "\n</div>\n<div style='left:" + o[i][3].left + "px;top:" + o[i][3].top + "px;width:" + a + "px'>\n  " + T(w.addDays(1)) + "\n</div>", i += 1
        };
        for (h = 0, d = v.length; h < d; h++) n = v[h], c(n);
        L("timezones", f), L("dates", r), L("times", s), i = 0, g = [];
        for (p = 0, m = ut.length; p < m; p++) u = ut[p], g.push(function (t) {
            return t.timeEl = e("time_" + i), i += 1
        }(u));
        return g
    }, $ = function () {
        var e, t, n, r, i;
        t = 0, i = [];
        for (n = 0, r = v.length; n < r; n++) e = v[n], i.push(function (e) {
            var n, r, i, s, u, a;
            return n = o[t], r = C(e[0], e[0] + 48 + q / 60), i = C(e[0], e[0] + 24 + q / 60), s = C(e[0], e[0] + q / 60), u = C(e[0], e[0] - 24 + q / 60), a = C(e[0], e[0] - 48 + q / 60), n[1].gradient !== i && x(n[1].left, n[1].top, n[1].gradient = i), n[2].gradient !== s && x(n[2].left, n[2].top, n[2].gradient = s), n[3].gradient !== u && x(n[3].left, n[3].top, n[3].gradient = u), t += 1
        }(e));
        return i
    }, V = function () {
        return c = {}, W(), it(), X(), $(), Tt(), wt()
    }, window.onorientationchange = V, window.onresize = V, S = !1, T = function (e) {
        return "" + j[e.getMonth()] + " " + e.getDate()
    }, N = function (e) {
        var t, n, r;
        return e < 0 && (e = 24 - Math.abs(e % 24)), e >= 24 && (e %= 24), t = Math.abs(e * 60 % 60 | 0), t < 10 && (t = "0" + t), e |= 0, n = "am", e >= 12 && (r = [e % 12, "pm"], e = r[0], n = r[1]), e === 0 && (e = 12), "" + e + ":" + t + " " + n
    }, wt = function (e) {
        var t, n, r, i, s;
        i = new Date, t = i.getUTCHours() * 60 + i.getUTCMinutes(), n = t - 720, r = -(i.getTimezoneOffset() / 60), s = kt / 2 + n / 60 / 24 * a, b("cnow", "left:" + s + "px"), L("clocaltime", N(n / 60 + B + 12));
        if (e) return b("now", "left:" + s + "px"), L("local1time", N(n / 60 + B + 12))
    }, St = null, Et = function (e) {
        var t, n, r, i;
        if (!e && St === q) return;
        St = q, L("localtime", N(q / 60 + 12 + B)), i = [];
        for (n = 0, r = ut.length; n < r; n++) t = ut[n], i.push(function (e) {
            return e.timeEl.innerHTML = N(q / 60 + 12 + e.offset)
        }(t));
        return i
    }, Z = function () {
        return "" + w.getFullYear() + "-" + (w.getMonth() + 1) + "-" + w.getDate() + "," + q + "," + Y()
    }, Tt = function (e) {
        var t, n;
        e == null && (e = q), t = kt / 2 + e / 60 / 24 * a, b("now", "left:" + t + "px"), n = t, t > kt - 100 && (n -= 85), b("times", "left:" + n + "px"), t < 200 && at === "left" && (dt("timezones", kt - (kt <= 480 ? 120 : 200), !0), at = "right");
        if (t > kt - (kt <= 480 ? 200 : 300) && at === "right") return dt("timezones", 0, !0), at = "left"
    }, Nt = function () {
        var t;
        return t = Z(), O = !0, location.hash = t, e("shortcut_link").setAttribute("href", "http://everytimezone.com/#" + t)
    }, ct = ht = -1, D = P = -1, lt = G = -1, h = !1, F = function (e) {
        var t, r;
        if (!S) return;
        r = e.pageX, e.touches != null && (r = D), r < 50 && (r = 50), r > kt - 50 && (r = kt - 50), q = Math.round((r - kt / 2) / a * 24 * 60), t = q, q -= q % 15, $(), Tt(t), n || Et();
        if (e.touches != null) return e.preventDefault()
    }, key("left", function () {
        q -= 15, q -= q % 15, $(), Tt();
        if (!n) return Et()
    }), key("right", function () {
        q += 15, q -= q % 15, $(), Tt();
        if (!n) return Et()
    }), f[st ? "ontouchstart" : "onmousedown"] = function (e) {
        var t, n;
        t = e.target, t.nodeType !== 1 && (t = t.parentNode);
        if (t.tagName == null || (n = t.tagName) !== "A" && n !== "IMG" && n !== "SELECT" && n !== "INPUT") {
            if (e.touches != null) {
                G = document.body.scrollTop, lt = Date.now(), ct = D = e.touches[0].pageX, ht = P = e.touches[0].pageY;
                if (e.touches[0].pageY < 50) return
            }
            return S = !0
        }
        return
    }, f[st ? "ontouchmove" : "onmousemove"] = function (e) {
        var t;
        if (e.touches != null) {
            D = e.touches[0].pageX, P = e.touches[0].pageY;
            if (!!h || document.body.scrollTop !== G) {
                h = !0;
                return
            }
            if (Date.now() - lt < 50) return;
            if (-10 < (t = ct - D) && t < 10) return
        }
        return F(e)
    }, f[st ? "ontouchend" : "onmouseup"] = function (e) {
        return st ? !h && G === document.body.scrollTop && F(e) : F(e), ct = ht = D = P = lt = G = -1, h = !1, S = !1, Nt()
    }, e("footer").onclick = function () {
        return location.href = "http://letsfreckle.com/"
    }, window.onhashchange = function () {
        if (O) {
            O = !1;
            return
        }
        return xt(), bt(U.cities), q = U.offset, tt(), Tt(), Et(!0), V()
    }, rt(), tt(), V(), wt(!0), Et(!0), Tt(), setInterval(wt, 1e3), n && setInterval(Et, 350), scrollTo(0, 1), M && function () {
        return i("wrapper", "scale(1)")
    }.delay(.5), window.applicationCache != null && (s = window.applicationCache, s.addEventListener("updateready", function () {
        if (confirm("There's a newer version of Every Time Zone available, reload now?")) return s.swapCache(), location.reload()
    }, !1));
    if (navigator.onLine == null || navigator.onLine) gt = document.createElement("script"), gt.innerHTML = '!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs")', m = document.createElement("script"), m.src = "//static.getclicky.com/js", e("body").appendChild(gt), e("body").appendChild(m), g = setInterval(function () {
        if (typeof clicky == "undefined" || clicky === null) return;
        clearInterval(g);
        try {
            return clicky.init(204109)
        } catch (e) {}
    }, 1e3)
}).call(this);
